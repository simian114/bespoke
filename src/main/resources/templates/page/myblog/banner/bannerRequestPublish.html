<!DOCTYPE html>
<html lang="en"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout/layout}"
>
<head>
    <title>Bespoke</title>
</head>
<body layout:fragment="content">

<section class="section px-2">
    <nav th:replace="page/myblog/navigator :: navigator"></nav>
    <div class="container">
        <div>
            <div class="block">
                <a
                        th:if="${canCreateNewForm}"
                        class="button"
                        th:href="@{/blog/manage/banners/{bannerId}/form(bannerId=${bannerId})}"
                >
                    create request form
                </a>
                <th:block th:unless="${canCreateNewForm}">
                    <button class="button" disabled th:unless="${canCreateNewForm}">
                        create request form
                    </button>
                    <p>can't create new form when there is on going form</p>
                </th:block>
                <br/>

            </div>
            <div class="block">
                TODO:
                현재 진행중인 form 하나만을 보여줌. 없으면 없음이라고 표현
                <h2>
                    on going form
                </h2>
            </div>
            <div class="block">
                TODO:
                해당 banner 가 가지고 있는 모든 form 리스트를 보여줌.
                한번에 가지고 있는 모든걸 가지고 온다.
                테이블 형태로 보여준다. status 를 반드시 보여줄 수 있어야 한다.
                <br/>
                나중에는 결제 까지 할 수 있어야 한다.
                <br/>
                <div class="table-container is-flex is-flex-direction-column is-justify-content-center	">
                    <!--  테이블 넣기  -->
                    <table class="table">
                        <thead>
                        <tr>
                            <th><abbr title="Status">status</abbr></th>
                            <th><abbr title="StartDate">startDate</abbr></th>
                            <th><abbr title="EndDate">endDate</abbr></th>
                            <th><abbr title="Created At">createdAt</abbr></th>
                            <th>actions</th>
                        </tr>
                        </thead>
                        <!--  tfoot  -->
                        <tfoot>
                        <tr>
                            <th><abbr title="Status">status</abbr></th>
                            <th><abbr title="StartDate">startDate</abbr></th>
                            <th><abbr title="EndDate">endDate</abbr></th>
                            <th><abbr title="Created At">createdAt</abbr></th>
                            <th>actions</th>
                        </tr>
                        </tfoot>
                        <tbody hx-swap="outerHTML">
                        <!-- tbody -->
                        <th:block th:each="item: ${items}">
                            <!--                    delete 된 post 라면 ...-->
                            <tr th:fragment="post-item-row">
                                <th><span th:text="${item.status}">status</span></th>
                                <th><span th:text="${item.startDate}">startDate</span></th>
                                <th><span th:text="${item.endDate}">endDate</span></th>
                                <th><span th:text="${item.createdAt}">createdAt</span></th>
                                <th class="buttons are-small">
                                    <th:block th:if="${item.status.name() == 'PAYMENT_WAITING'}">
                                        <!--TODO: 지금은 임시로 버튼과 경로만 만들어놓음-->
                                        <!--실제 결제 프로세스가 도입되면, 어드민에서 approve 하는 순간 payment 가 생기고, 아래의 경로에는 payment 에 대한 결제 경로가 생성이됨.-->
                                        <button class="button is-primary"
                                                hx:post="@{/blog/manage/banners/{bannerId}/forms/{bannerFormId}/pay(bannerId=${0},bannerFormId=${item.id})}"
                                        >
                                            pay(current free!)
                                        </button>
                                    </th:block>

                                </th>
                            </tr>
                        </th:block>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</section>


</body>
</html>